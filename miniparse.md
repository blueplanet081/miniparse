# miniparse -- 簡易コマンドラインパーサ

## 作成経緯

CLIベースのコマンドを試作／製作するとき、起動オプションの処理を手軽に記述したかった。同種のものを探したけど見つからなかったので、Python学習も兼ねて作成。

</br>

## パッケージ構成

ファイル名         | 内容
------------------|----
miniparse.md      | このドキュメント
miniparse.py      | miniparse本体（使うのに必要なのはこのファイルだけです）
ptree.py          | miniparse使用サンプル。いわゆる treeコマンドの試作版です。
e2_path.py        | ptree.pyが呼び出している自作ライブラリ（添付用簡易版）
miniparse_test.py | 古いテスト用プログラムです。見なかったことにしてください。

</br>

## 履歴

バージョン   |日付     |変更箇所        | コメント 
------------|---------|---------------|------
0.5くらい    |2020/8/27|               |いちおう完成
0.6くらい    |2020/9/1 |miniparse.py  |コマンド引数のホームディレクトリ、ワイルドカード展開を追加</br>(Windowsで使用の場合のみ)
0.8くらい    |2020/9/3|miniparse.py   |Let's Python@facebook でアドバイスを受けて、解析部大幅変更</br>(一部機能制限暫定版)
〃　          |〃    |ptree.py    |miniparse.py処理変更に伴って、呼び出し方一部変更


</br>

## 使い方

```py
import sys
import miniparse as mp

ops = {'': mp.Oset(False, False, '[ディレクトリ]', ''),
       'a': mp.Oset(False, False, '', 'ドットやシステムディレクトリも表示'),
       'L': mp.Oset(False, True, '階層数', '表示するディレクトリの深さを指定する'),
       'd': mp.Oset(False, False, '', 'ディレクトリのみ表示'),
       'E': mp.Oset(False, False, '', 'ツリーの表示に拡張文字を使用'),
       'h': mp.Oset(False, False, '', '使い方を表示'),
       }


```

１．辞書型の変数に、コマンドラインオプション情報を定義します。
* keyは、空文字はコマンドラインアーギュメント、１文字は - で指定するオプション、複数文字は -- で指定する長いオプションになります。
* クラス Oset の第一引数は、オプションが指定されたかどうかで、初期値は Falseを指定します。
* 第二引数は、オプションがアーギュメントをとるかどうかで、Trule/Falseを指定します。
* 第三引数、第四引数はコメントで、それぞれオプションアーギュメント、オプションの説明を書きます。</br>
  このコメントは、usage:メッセージを自動作成するときに使われます。

２．コマンドライン引数とコマンドラインオプション情報を指定して、miniparse() を呼びます。

```py
# すみません、暫定版です
myArgs = mp.wArgs(sys.argv)
mp.miniparse(myArgs[1:], ops)

```

３．結果は、以下のように取得します。
* 入力されたオプションは、ops['オプション'].isTrue が True になります。
* 入力されたオプションアーギュメントは、ops['オプション'].opArg に格納されます。
* コマンドアーギュメントは、mp.arguments() で取得します。List[str]型になります。
* コマンドラインオプション情報で、空文字のkeyを指定していた場合は、ops[''].opArg にも、コマンドアーギュメントが格納されます。（複数入力された場合は、最初の一つだけ）
</br></br>

以下使用例
```py
# すみません、改訂中です

```